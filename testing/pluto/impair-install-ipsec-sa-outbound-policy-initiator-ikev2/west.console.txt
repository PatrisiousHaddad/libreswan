/testing/guestbin/swan-prep
west #
 # confirm that the network is alive
west #
 ../../guestbin/wait-until-alive -I 192.0.1.254 192.0.2.254
destination -I 192.0.1.254 192.0.2.254 is alive
west #
 # ensure that clear text does not get through
west #
 iptables -A INPUT -i eth1 -s 192.0.2.0/24 -j DROP
west #
 iptables -I INPUT -m policy --dir in --pol ipsec -j ACCEPT
west #
 # confirm clear text does not get through
west #
 ../../guestbin/ping-once.sh --down -I 192.0.1.254 192.0.2.254
down
west #
 ipsec start
Redirecting to: [initsystem]
west #
 ../../guestbin/wait-until-pluto-started
west #
 ipsec add west-east
"west-east": added IKEv2 connection
west #
 ipsec whack --impair suppress_retransmits
west #
 ipsec whack --impair revival
west #
 ipsec route west-east
west #
 ipsec whack --impair install_ipsec_sa_outbound_policy
west #
 # Initiate; during IKE_AUTH the child should fail and the connection
west #
 # put on to the revival queue
west #
 ipsec up west-east
"west-east" #1: initiating IKEv2 connection to 192.1.2.23 using UDP
"west-east" #1: sent IKE_SA_INIT request to 192.1.2.23:UDP/500
"west-east" #1: processed IKE_SA_INIT response from 192.1.2.23:UDP/500 {cipher=AES_GCM_16_256 integ=n/a prf=HMAC_SHA2_512 group=DH19}, initiating IKE_AUTH
"west-east" #1: sent IKE_AUTH request to 192.1.2.23:UDP/500
"west-east" #1: initiator established IKE SA; authenticated peer using authby=secret and ID_FQDN '@east'
"west-east" #2: IMPAIR: kernel: install_ipsec_sa_outbound_policy in install_outbound_ipsec_kernel_policies()
"west-east" #2: CHILD SA encountered fatal error: INVALID_SYNTAX
"west-east" #1: encountered fatal error in state STATE_V2_ESTABLISHED_IKE_SA
"west-east" #2: connection is supposed to remain up; revival attempt 1 scheduled in 0 seconds
"west-east" #2: IMPAIR: revival: skip scheduling revival event
"west-east" #1: deleting IKE SA (ESTABLISHED_IKE_SA) and NOT sending notification
west #
 # expect the on-demand kernel policy
west #
 ../../guestbin/ipsec-kernel-policy.sh
src 192.0.1.0/24 dst 192.0.2.0/24
	dir out priority PRIORITY ptype main
	tmpl src 0.0.0.0 dst 0.0.0.0
		proto esp reqid 0 mode transport
west #
 # Trigger an acquire; this fast track the revival using
west #
 # CREATE_CHILD_SA and again it will fail
west #
 ../../guestbin/ping-once.sh --down -I 192.0.1.254 192.0.2.254
down
west #
 ../../guestbin/wait-for-pluto.sh '#3: IMPAIR: revival'
timeout waiting 30 seconds for cat /tmp/pluto.log to match #3: IMPAIR: revival
output: |    next payload type: ISAKMP_NEXT_v2NONE (0x0)
output: |    flags: none (0x0)
output: | next payload chain: setting previous 'ISAKMP Message'.'next payload type' to current IKEv2 Encryption Payload (46:ISAKMP_NEXT_v2SK)
output: | next payload chain: saving location 'IKEv2 Encryption Payload'.'next payload type' in 'IKE_AUTH request'
output: | emitting 8 zero bytes of IV into IKEv2 Encryption Payload
output: | IKEv2 CERT: not sending cert: local leftauthby=PSK does not have RSA or ECDSA
output: | IDr payload will be sent
output: | ****emit IKEv2 Identification - Initiator - Payload:
output: |    next payload type: ISAKMP_NEXT_v2NONE (0x0)
output: |    flags: none (0x0)
output: |    ID type: ID_FQDN (0x2)
output: |    reserved: 00 00 00
output: | next payload chain: setting previous 'IKEv2 Encryption Payload'.'next payload type' to current IKEv2 Identification - Initiator - Payload (35:ISAKMP_NEXT_v2IDi)
output: | next payload chain: saving location 'IKEv2 Identification - Initiator - Payload'.'next payload type' in 'IKE_AUTH request'
output: | emitting 4 raw bytes of my identity into IKEv2 Identification - Initiator - Payload
output: | my identity: 77 65 73 74
output: | emitting length of IKEv2 Identification - Initiator - Payload: 12
output: | IKEv2 CERTREQ: send a cert request?
output: | IKEv2 CERTREQ: responder has no auth method requiring them to send back their cert
output: | ****emit IKEv2 Identification - Responder - Payload:
output: |    next payload type: ISAKMP_NEXT_v2NONE (0x0)
output: |    flags: none (0x0)
output: |    ID type: ID_FQDN (0x2)
output: |    reserved: 00 00 00
output: | next payload chain: setting previous 'IKEv2 Identification - Initiator - Payload'.'next payload type' to current IKEv2 Identification - Responder - Payload (36:ISAKMP_NEXT_v2IDr)
output: | next payload chain: saving location 'IKEv2 Identification - Responder - Payload'.'next payload type' in 'IKE_AUTH request'
output: | emitting 4 raw bytes of their IDr into IKEv2 Identification - Responder - Payload
output: | their IDr: 65 61 73 74
output: | emitting length of IKEv2 Identification - Responder - Payload: 12
output: | not sending INITIAL_CONTACT
output: | ****emit IKEv2 Authentication Payload:
output: |    next payload type: ISAKMP_NEXT_v2NONE (0x0)
output: |    flags: none (0x0)
output: |    auth method: IKEv2_AUTH_SHARED (0x2)
output: | next payload chain: setting previous 'IKEv2 Identification - Responder - Payload'.'next payload type' to current IKEv2 Authentication Payload (39:ISAKMP_NEXT_v2AUTH)
output: | next payload chain: saving location 'IKEv2 Authentication Payload'.'next payload type' in 'IKE_AUTH request'
output: | emitting 64 raw bytes of signature into IKEv2 Authentication Payload
output: |   d0 0a 38 7e  b4 d9 92 82  b1 25 7a 8a  a2 b8 82 ae   ..8~.....%z.....
output: |   cb 40 49 80  b9 f3 eb d8  81 6e 61 6f  76 a6 9d f4   .@I......naov...
output: |   e8 20 e8 54  fc e0 f0 99  38 20 cc 14  95 78 97 f1   . .T....8 ...x..
output: |   c4 81 fc c1  e0 98 22 fd  8f f5 20 14  e4 c2 b2 7e   ......"... ....~
output: | emitting length of IKEv2 Authentication Payload: 72
output: | "west-east": no whack to attach
output: | pending: first_pending() ike 0x7f6b70171348 pending 0x7f6b70183fa8 connection 0x7f6b70b9da78 ike 0x7f6b70171348
output: | struct iface_endpoint: addref @0x7f6b70babf38(3->4) (duplicate_state() +1198 programs/pluto/state.c)
output: | alloc logger: newref @0x7f6b70078fc8(0->1) (duplicate_state() +1206 programs/pluto/state.c)
output: |  #0: no whack to attach
output: | "west-east": addref @0x7f6b70b9da78(3->4)  #4:  (new_state() +491 programs/pluto/state.c)
output: | creating state object #4 at 0x7f6b70023348
output: | pstats #4 ikev2.child started
output: | duplicating state object #3 "west-east" as #4 for IPSEC SA
output: | #4 setting local endpoint to 192.1.2.45:500 from #3.st_localport (duplicate_state() +1220 programs/pluto/state.c)
output: | duplicate_state: addref st_skeyid_nss-key@NULL
output: | duplicate_state: addref st_skey_d_nss-key@0x7f6b70181f80
output: | duplicate_state: addref st_skey_ai_nss-key@NULL
output: | duplicate_state: addref st_skey_ar_nss-key@NULL
output: | duplicate_state: addref st_skey_ei_nss-key@0x7f6b70cc4f80
output: | duplicate_state: addref st_skey_er_nss-key@0x7f6b70b15f80
output: | duplicate_state: addref st_skey_pi_nss-key@0x7f6b70cb5f80
output: | duplicate_state: addref st_skey_pr_nss-key@0x7f6b70c0ef80
output: | duplicate_state: addref st_enc_key_nss-key@NULL
output: | child state #4: UNDEFINED(ignore) => IKE_AUTH_CHILD_I0(ignore)
output: | #4.st_v2_transition NULL -> IKE_AUTH_CHILD_I0->ESTABLISHED_CHILD_SA (new_v2_child_sa() +1296 programs/pluto/state.c)
output: | "west-east": addref @0x7f6b70b9da78(4->5) "west-east" #4:  (dispatch() +2436 programs/pluto/routing.c)
output: | "west-east" #4: routing: start INITIATED, ROUTED_NEGOTIATION, PERMANENT; IKE #3 (PARENT_I1) Child #4 (IKE_AUTH_CHILD_I0) by=IKE; $1@0x7f6b70b9da78; routing_sa #3 negotiating_ike_sa #3 (initiate_v2_IKE_AUTH_request_signature_continue() +334 programs/pluto/ikev2_ike_auth.c)
output: | "west-east" #4: routing:   Child SA's IKE SA matches .routing_sa
output: | "west-east" #4: routing: stop INITIATED, ROUTED_NEGOTIATION, PERMANENT; ok=yes; routing_sa #3->#4 negotiating_ike_sa #3 negotiating_child_sa #0->#4 (initiate_v2_IKE_AUTH_request_signature_continue() +334 programs/pluto/ikev2_ike_auth.c)
output: | "west-east": delref @0x7f6b70b9da78(5->4) "west-east" #4:  (dispatch() +2450 programs/pluto/routing.c)
output: | "west-east": releasing whack (but there are none) (initiate_v2_IKE_AUTH_request_signature_continue() +340 programs/pluto/ikev2_ike_auth.c)
output: | "west-east" #4: routing:  kernel_ops_get_ipsec_spi() 192.1.2.23-ESP->192.1.2.45 reqid=4005 [1000,ffffffff] for SPI ...
output: | sendrecv_xfrm_msg() sending 22 Get SPI SPI
output: | sendrecv_xfrm_msg() recvfrom() returned 256 bytes
output: | "west-east" #4: routing:   ... allocated 6274be95 for SPI
output: | Emitting ikev2_proposals ...
output: | ****emit IKEv2 Security Association Payload:
output: |    next payload type: ISAKMP_NEXT_v2NONE (0x0)
output: |    flags: none (0x0)
output: | next payload chain: setting previous 'IKEv2 Authentication Payload'.'next payload type' to current IKEv2 Security Association Payload (33:ISAKMP_NEXT_v2SA)
output: | next payload chain: saving location 'IKEv2 Security Association Payload'.'next payload type' in 'IKE_AUTH request'
output: | discard INTEG=NONE when counting transforms (multiple 0; allow single 0)
output: | discard DH=NONE when counting transforms (multiple 0; allow single 0)
output: | *****emit IKEv2 Proposal Substructure Payload:
output: |    last proposal: v2_PROPOSAL_NON_LAST (0x2)
output: |    prop #: 1 (01)
output: |    proto ID: IKEv2_SEC_PROTO_ESP (0x3)
output: |    spi size: 4 (04)
output: |    # transforms: 3 (03)
output: | last substructure: saving location 'IKEv2 Security Association Payload'.'IKEv2 Proposal Substructure Payload'.'last proposal'
output: | emitting 4 raw bytes of our spi into IKEv2 Proposal Substructure Payload
output: | our spi: 62 74 be 95
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ENCR (0x1)
output: |    IKEv2 transform ID: AES_GCM_C (0x14)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | *******emit IKEv2 Attribute Substructure Payload:
output: |    af+type: AF+IKEv2_KEY_LENGTH (0x800e)
output: |    length/value: 256 (01 00)
output: | emitting length of IKEv2 Transform Substructure Payload: 12
output: | discard INTEG=NONE when emitting proposal (multiple 0; allow single 0)
output: | discard DH=NONE when emitting proposal (multiple 0; allow single 0)
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_YES (0x1)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_LAST (0x0)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_NO (0x0)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | emitting length of IKEv2 Proposal Substructure Payload: 40
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' is 0
output: | discard INTEG=NONE when counting transforms (multiple 0; allow single 0)
output: | discard DH=NONE when counting transforms (multiple 0; allow single 0)
output: | *****emit IKEv2 Proposal Substructure Payload:
output: |    last proposal: v2_PROPOSAL_NON_LAST (0x2)
output: |    prop #: 2 (02)
output: |    proto ID: IKEv2_SEC_PROTO_ESP (0x3)
output: |    spi size: 4 (04)
output: |    # transforms: 3 (03)
output: | last substructure: checking 'IKEv2 Security Association Payload'.'IKEv2 Proposal Substructure Payload'.'last proposal' containing v2_PROPOSAL_NON_LAST (0x2) is v2_PROPOSAL_NON_LAST (0x2)
output: | last substructure: saving location 'IKEv2 Security Association Payload'.'IKEv2 Proposal Substructure Payload'.'last proposal'
output: | emitting 4 raw bytes of our spi into IKEv2 Proposal Substructure Payload
output: | our spi: 62 74 be 95
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ENCR (0x1)
output: |    IKEv2 transform ID: AES_GCM_C (0x14)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | *******emit IKEv2 Attribute Substructure Payload:
output: |    af+type: AF+IKEv2_KEY_LENGTH (0x800e)
output: |    length/value: 128 (00 80)
output: | emitting length of IKEv2 Transform Substructure Payload: 12
output: | discard INTEG=NONE when emitting proposal (multiple 0; allow single 0)
output: | discard DH=NONE when emitting proposal (multiple 0; allow single 0)
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_YES (0x1)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_LAST (0x0)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_NO (0x0)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | emitting length of IKEv2 Proposal Substructure Payload: 40
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' is 0
output: | discard INTEG=NONE when counting transforms (multiple 0; allow single 0)
output: | discard DH=NONE when counting transforms (multiple 0; allow single 0)
output: | *****emit IKEv2 Proposal Substructure Payload:
output: |    last proposal: v2_PROPOSAL_NON_LAST (0x2)
output: |    prop #: 3 (03)
output: |    proto ID: IKEv2_SEC_PROTO_ESP (0x3)
output: |    spi size: 4 (04)
output: |    # transforms: 3 (03)
output: | last substructure: checking 'IKEv2 Security Association Payload'.'IKEv2 Proposal Substructure Payload'.'last proposal' containing v2_PROPOSAL_NON_LAST (0x2) is v2_PROPOSAL_NON_LAST (0x2)
output: | last substructure: saving location 'IKEv2 Security Association Payload'.'IKEv2 Proposal Substructure Payload'.'last proposal'
output: | emitting 4 raw bytes of our spi into IKEv2 Proposal Substructure Payload
output: | our spi: 62 74 be 95
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ENCR (0x1)
output: |    IKEv2 transform ID: CHACHA20_POLY1305 (0x1c)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | discard INTEG=NONE when emitting proposal (multiple 0; allow single 0)
output: | discard DH=NONE when emitting proposal (multiple 0; allow single 0)
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_YES (0x1)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_LAST (0x0)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_NO (0x0)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | emitting length of IKEv2 Proposal Substructure Payload: 36
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' is 0
output: | discard DH=NONE when counting transforms (multiple 0; allow single 0)
output: | *****emit IKEv2 Proposal Substructure Payload:
output: |    last proposal: v2_PROPOSAL_NON_LAST (0x2)
output: |    prop #: 4 (04)
output: |    proto ID: IKEv2_SEC_PROTO_ESP (0x3)
output: |    spi size: 4 (04)
output: |    # transforms: 5 (05)
output: | last substructure: checking 'IKEv2 Security Association Payload'.'IKEv2 Proposal Substructure Payload'.'last proposal' containing v2_PROPOSAL_NON_LAST (0x2) is v2_PROPOSAL_NON_LAST (0x2)
output: | last substructure: saving location 'IKEv2 Security Association Payload'.'IKEv2 Proposal Substructure Payload'.'last proposal'
output: | emitting 4 raw bytes of our spi into IKEv2 Proposal Substructure Payload
output: | our spi: 62 74 be 95
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ENCR (0x1)
output: |    IKEv2 transform ID: AES_CBC (0xc)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | *******emit IKEv2 Attribute Substructure Payload:
output: |    af+type: AF+IKEv2_KEY_LENGTH (0x800e)
output: |    length/value: 256 (01 00)
output: | emitting length of IKEv2 Transform Substructure Payload: 12
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_INTEG (0x3)
output: |    IKEv2 transform ID: AUTH_HMAC_SHA2_512_256 (0xe)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_INTEG (0x3)
output: |    IKEv2 transform ID: AUTH_HMAC_SHA2_256_128 (0xc)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | discard DH=NONE when emitting proposal (multiple 0; allow single 0)
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_YES (0x1)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_LAST (0x0)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_NO (0x0)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | emitting length of IKEv2 Proposal Substructure Payload: 56
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' is 0
output: | discard DH=NONE when counting transforms (multiple 0; allow single 0)
output: | *****emit IKEv2 Proposal Substructure Payload:
output: |    last proposal: v2_PROPOSAL_LAST (0x0)
output: |    prop #: 5 (05)
output: |    proto ID: IKEv2_SEC_PROTO_ESP (0x3)
output: |    spi size: 4 (04)
output: |    # transforms: 5 (05)
output: | last substructure: checking 'IKEv2 Security Association Payload'.'IKEv2 Proposal Substructure Payload'.'last proposal' containing v2_PROPOSAL_NON_LAST (0x2) is v2_PROPOSAL_NON_LAST (0x2)
output: | last substructure: saving location 'IKEv2 Security Association Payload'.'IKEv2 Proposal Substructure Payload'.'last proposal'
output: | emitting 4 raw bytes of our spi into IKEv2 Proposal Substructure Payload
output: | our spi: 62 74 be 95
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ENCR (0x1)
output: |    IKEv2 transform ID: AES_CBC (0xc)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | *******emit IKEv2 Attribute Substructure Payload:
output: |    af+type: AF+IKEv2_KEY_LENGTH (0x800e)
output: |    length/value: 128 (00 80)
output: | emitting length of IKEv2 Transform Substructure Payload: 12
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_INTEG (0x3)
output: |    IKEv2 transform ID: AUTH_HMAC_SHA2_512_256 (0xe)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_INTEG (0x3)
output: |    IKEv2 transform ID: AUTH_HMAC_SHA2_256_128 (0xc)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | discard DH=NONE when emitting proposal (multiple 0; allow single 0)
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_YES (0x1)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | ******emit IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_LAST (0x0)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_NO (0x0)
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' containing v2_TRANSFORM_NON_LAST (0x3) is v2_TRANSFORM_NON_LAST (0x3)
output: | last substructure: saving location 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform'
output: | emitting length of IKEv2 Transform Substructure Payload: 8
output: | emitting length of IKEv2 Proposal Substructure Payload: 56
output: | last substructure: checking 'IKEv2 Proposal Substructure Payload'.'IKEv2 Transform Substructure Payload'.'last transform' is 0
output: | emitting length of IKEv2 Security Association Payload: 232
output: | last substructure: checking 'IKEv2 Security Association Payload'.'IKEv2 Proposal Substructure Payload'.'last proposal' is 0
output: | CP: send-v2CP=no; left: local; right: remote;
output: | ****emit IKEv2 Traffic Selector - Initiator - Payload:
output: |    next payload type: ISAKMP_NEXT_v2NONE (0x0)
output: |    flags: none (0x0)
output: |    number of TS: 1 (01)
output: | next payload chain: setting previous 'IKEv2 Security Association Payload'.'next payload type' to current IKEv2 Traffic Selector - Initiator - Payload (44:ISAKMP_NEXT_v2TSi)
output: | next payload chain: saving location 'IKEv2 Traffic Selector - Initiator - Payload'.'next payload type' in 'IKE_AUTH request'
output: | *****emit IKEv2 Traffic Selector Header:
output: |    TS type: IKEv2_TS_IPV4_ADDR_RANGE (0x7)
output: |    IP Protocol ID: ALL (0x0)
output: | ******emit IKEv2 IP Traffic Selector port range:
output: |    start port: 0 (00 00)
output: |    end port: 65535 (ff ff)
output: | emitting 4 raw bytes of IP start into IKEv2 Traffic Selector Header
output: | IP start: c0 00 01 00
output: | emitting 4 raw bytes of IP end into IKEv2 Traffic Selector Header
output: | IP end: c0 00 01 ff
output: | emitting length of IKEv2 Traffic Selector Header: 16
output: | emitting length of IKEv2 Traffic Selector - Initiator - Payload: 24
output: | ****emit IKEv2 Traffic Selector - Responder - Payload:
output: |    next payload type: ISAKMP_NEXT_v2NONE (0x0)
output: |    flags: none (0x0)
output: |    number of TS: 1 (01)
output: | next payload chain: setting previous 'IKEv2 Traffic Selector - Initiator - Payload'.'next payload type' to current IKEv2 Traffic Selector - Responder - Payload (45:ISAKMP_NEXT_v2TSr)
output: | next payload chain: saving location 'IKEv2 Traffic Selector - Responder - Payload'.'next payload type' in 'IKE_AUTH request'
output: | *****emit IKEv2 Traffic Selector Header:
output: |    TS type: IKEv2_TS_IPV4_ADDR_RANGE (0x7)
output: |    IP Protocol ID: ALL (0x0)
output: | ******emit IKEv2 IP Traffic Selector port range:
output: |    start port: 0 (00 00)
output: |    end port: 65535 (ff ff)
output: | emitting 4 raw bytes of IP start into IKEv2 Traffic Selector Header
output: | IP start: c0 00 02 00
output: | emitting 4 raw bytes of IP end into IKEv2 Traffic Selector Header
output: | IP end: c0 00 02 ff
output: | emitting length of IKEv2 Traffic Selector Header: 16
output: | emitting length of IKEv2 Traffic Selector - Responder - Payload: 24
output: | Initiator child policy is transport mode, sending v2N_USE_TRANSPORT_MODE? no
output: | adding 1 bytes of padding (including 1 byte padding-length)
output: | emitting 0 as 1 bytes of padding and length into IKEv2 Encryption Payload
output: | emitting 16 zero bytes of length of truncated HMAC/KEY into IKEv2 Encryption Payload
output: | emitting length of IKEv2 Encryption Payload: 405
output: | emitting length of ISAKMP Message: 433
output: | recording outgoing fragment failed
output: | job 4 helper 1 #3 process_v2_IKE_SA_INIT_response (dh): final status STF_OK; cleaning up
output: | delref @0x7f6b7002bfd8(2->1) (cleanup_dh_shared_secret() +170 programs/pluto/crypt_dh.c)
output: | DH: delref secret-key@NULL
output: | "west-east" #3: releasing whack (but there are none) (free_job() +430 programs/pluto/server_pool.c)
output: | logger: delref @0x7f6b70009fc8(1->0) (free_job() +430 programs/pluto/server_pool.c)
output: | job: delref @0x7f6b70005f98(1->0) (free_job() +431 programs/pluto/server_pool.c)
output: | #3 complete_v2_state_transition() PARENT_I1->PARENT_I2 with status STF_OK
output: | transitioning from state STATE_V2_PARENT_I1 to state STATE_V2_PARENT_I2
output: | Message ID: updating counters for #3
output: | Message ID: IKE #3 clearing EVENT_RETRANSMIT as response received (initiator: .sent=0 .recv=-1 .recv_frags=0 .wip=-1 .last_sent=13.068157 .last_recv=13.005023 responder: .sent=-1 .recv=-1 .recv_frags=0 .wip=-1 .last_sent=13.005023 .last_recv=13.005023)
output: | #3 requesting EVENT_RETRANSMIT-event@0x7f6b70ba7fa8 be deleted (clear_retransmits() +108 programs/pluto/retransmit.c)
output: | #3 deleting EVENT_RETRANSMIT
output: | tt: delref @0x7f6b70036f68(1->0) (destroy_timeout() +575 programs/pluto/server.c)
output: | state-event: delref @0x7f6b70ba7fa8(1->0) (clear_retransmits() +108 programs/pluto/retransmit.c)
output: | #3 STATE_V2_PARENT_I1: retransmits: cleared
output: | Message ID: IKE #3 updating initiator received message response 0 (initiator: .recv=-1->0 .wip=0->-1 .last_recv=13.005023->13.230877 responder:)
output: | Message ID: IKE #3 scheduling EVENT_RETRANSMIT (initiator: .sent=0 .recv=0 .recv_frags=0 .wip=1 .last_sent=13.068157 .last_recv=13.230877 responder: .sent=-1 .recv=-1 .recv_frags=0 .wip=-1 .last_sent=13.005023 .last_recv=13.005023)
output: | event_schedule_where: newref EVENT_RETRANSMIT-pe@0x7f6b70ba7fa8 timeout in 60 seconds for #3
output: | tt: newref @0x7f6b70036f68(0->1) (schedule_timeout() +557 programs/pluto/server.c)
output: | #3 STATE_V2_PARENT_I1: retransmits: first event in 60 seconds; timeout in 60 seconds; limit of 12 retransmits; current time is 13.231177
output: | Message ID: IKE #3 updating initiator sent message request 1 (initiator: .sent=0->1 .wip=-1->1 .last_sent=13.068157->13.231451 responder:)
output: | parent state #3: PARENT_I1(half-open IKE SA) => PARENT_I2(open IKE SA)
output: | Message ID: IKE #3 no pending message initiators to schedule (initiator: .sent=1 .recv=0 .recv_frags=0 .wip=1 .last_sent=13.231451 .last_recv=13.230877 responder: .sent=-1 .recv=-1 .recv_frags=0 .wip=-1 .last_sent=13.005023 .last_recv=13.005023)
output: | checking that a retransmit timeout_event was already
output: | #3 deleting EVENT_CRYPTO_TIMEOUT
output: | tt: delref @0x7f6b7000df68(1->0) (destroy_timeout() +575 programs/pluto/server.c)
output: | state-event: delref @0x7f6b7000bfa8(1->0) (delete_event() +534 programs/pluto/timer.c)
output: | sending 433 bytes for Initiator: process IKE_SA_INIT reply, initiate IKE_AUTH or IKE_INTERMEDIATE through eth1 from 192.1.2.45:500 to 192.1.2.23:500 using UDP (for #3)
output: |   ba ea 9d 3f  52 24 98 9b  96 b9 47 47  d3 fe ee 8b   ...?R$....GG....
output: |   2e 20 23 08  00 00 00 01  00 00 01 b1  23 00 01 95   . #.........#...
output: |   9f 0e f2 cf  ac 01 c5 52  c8 a5 ab e6  6f a9 d8 15   .......R....o...
output: |   4e 8c f3 23  37 0e 65 7e  90 f9 53 2e  66 83 e5 1b   N..#7.e~..S.f...
output: |   4a 56 20 4a  60 28 12 82  0c c3 05 c0  fc cd db ac   JV J`(..........
output: |   ac dc 28 4f  cf 25 ce e1  97 8b c2 52  87 58 a7 39   ..(O.%.....R.X.9
output: |   1d 3d bd 1e  84 fa c0 ab  66 45 a8 c0  cd 50 1f b9   .=......fE...P..
output: |   b5 32 06 42  45 56 a8 88  d5 60 37 55  c4 a9 5e cb   .2.BEV...`7U..^.
output: |   61 10 e9 f9  0f 9f 97 a3  1f fe 28 a4  0c 63 10 a4   a.........(..c..
output: |   ce 24 59 a8  e3 75 fe 83  2f 6f c3 cf  97 9e 26 77   .$Y..u../o....&w
output: |   5f 98 f9 e5  20 0f f7 d7  46 45 6f 2c  6e 30 9a e5   _... ...FEo,n0..
output: |   ff 76 9b 16  bc fb 97 10  90 70 50 47  c7 8a 26 f4   .v.......pPG..&.
output: |   22 16 ff c4  a6 fc af 8a  bf 4b 43 1a  91 0e 04 d0   "........KC.....
output: |   5c 05 46 15  a0 e9 90 c0  df da b1 4a  cf d9 16 37   \.F........J...7
output: |   fa 6c 45 f4  6e 1b e2 7a  4e 1c 3b 66  d4 93 6e f4   .lE.n..zN.;f..n.
output: |   af 16 c1 a1  ac d1 26 40  7b a2 8b b3  51 7c 4d a2   ......&@{...Q|M.
output: |   6a 80 82 a9  fe 04 33 37  09 bc 53 4b  6d 46 09 fa   j.....37..SKmF..
output: |   9f 8d ea 0b  15 20 5f 9e  3a f5 b6 97  57 26 77 7a   ..... _.:...W&wz
output: |   17 3e 56 21  b6 eb b9 e1  96 d3 0f d7  61 38 08 4e   .>V!........a8.N
output: |   85 a2 73 c0  c9 5d 2a 36  61 a1 7a f4  82 f2 9c 2f   ..s..]*6a.z..../
output: |   64 52 5b 5c  81 c8 58 a7  c0 b7 57 31  27 20 8a 7f   dR[\..X...W1' ..
output: |   ab 7c b8 43  ac f0 c5 d3  0e 8e f5 e6  59 f4 ed ce   .|.C........Y...
output: |   40 9d 7c ef  8b ac e3 3e  17 bf 77 80  ca cc da 77   @.|....>..w....w
output: |   c9 cd 76 42  1c ae 02 ba  1b 31 fe 3c  3d f3 6e 54   ..vB.....1.<=.nT
output: |   36 9c 2c 16  db e5 e4 92  c4 16 3c 3e  3b f4 c5 4c   6.,.......<>;..L
output: |   5d 6b aa 6c  81 66 8a 7d  a7 51 b0 4b  58 a6 1d 71   ]k.l.f.}.Q.KX..q
output: |   9e 63 67 e9  3b ce 07 e0  1f 69 0d 12  f5 ba 77 d4   .cg.;....i....w.
output: |   9a                                                   .
output: | sent 1 messages
output: "west-east" #3: sent IKE_AUTH request to 192.1.2.23:UDP/500
output: | packet from 192.1.2.23:500: delref @0x7f6b701f36f8(1->0) (resume_handler() +687 programs/pluto/server.c)
output: | packet from 192.1.2.23:500: releasing whack (but there are none) (resume_handler() +687 programs/pluto/server.c)
output: | logger: delref @0x7f6b70074fc8(1->0) (resume_handler() +687 programs/pluto/server.c)
output: | delref @0x7f6b70babf38(4->3) (resume_handler() +687 programs/pluto/server.c)
output: | #3 spent 10.8 (52.8) milliseconds in resume sending job back to main thread
output: | tt: delref @0x7f6b70011f68(1->0) (destroy_timeout() +575 programs/pluto/server.c)
output: | spent 0.00121 (0.0022) milliseconds in udp_read_packet() calling check_incoming_msg_errqueue()
output: | struct msg_digest: newref @0x7f6b701f3708(0->1) (udp_read_packet() +249 programs/pluto/iface_udp.c)
output: | struct iface_endpoint: addref @0x7f6b70babf38(3->4) (udp_read_packet() +249 programs/pluto/iface_udp.c)
output: | alloc logger: newref @0x7f6b70074fc8(0->1) (udp_read_packet() +249 programs/pluto/iface_udp.c)
output: | *received 225 bytes from 192.1.2.23:500 on eth1 192.1.2.45:500 using UDP
output: |   ba ea 9d 3f  52 24 98 9b  96 b9 47 47  d3 fe ee 8b   ...?R$....GG....
output: |   2e 20 23 20  00 00 00 01  00 00 00 e1  24 00 00 c5   . # ........$...
output: |   9a cd 08 52  69 c2 71 1b  6b 84 2f 90  25 cb a8 6b   ...Ri.q.k./.%..k
output: |   f5 be a6 5d  d8 24 31 75  cd 45 04 06  68 9e 7f 8f   ...].$1u.E..h...
output: |   d8 e8 04 50  18 75 e6 95  09 2b f6 34  03 db d1 fc   ...P.u...+.4....
output: |   92 cf b1 61  6f a1 44 45  3b d1 16 4b  41 19 f6 91   ...ao.DE;..KA...
output: |   68 f4 cf 3c  e4 42 ce ce  af a8 bf fd  c5 fc 9e e2   h..<.B..........
output: |   89 98 35 ec  4a 7e 50 ae  1c a6 d5 91  62 85 30 69   ..5.J~P.....b.0i
output: |   fb 06 cb bd  cf 96 c5 a7  d8 83 18 a0  99 87 b1 88   ................
output: |   f5 7a 39 84  4c bb 93 bb  69 b6 1b 7b  5d ff 27 53   .z9.L...i..{].'S
output: |   0b 37 90 f7  2c 62 61 8c  d8 3d 0d 72  6c 40 d2 68   .7..,ba..=.rl@.h
output: |   28 fe 20 ff  6a 00 82 6e  79 a7 c2 89  7c 68 c7 f5   (. .j..ny...|h..
output: |   f2 a3 24 60  66 ff 93 bc  b2 11 70 2d  29 6d 45 47   ..$`f.....p-)mEG
output: |   6f a2 9d 2c  9f b5 8c a3  a1 78 2c 22  ca 83 c0 6d   o..,.....x,"...m
output: |   22                                                   "
output: | **parse ISAKMP Message:
output: |    initiator SPI: ba ea 9d 3f  52 24 98 9b
output: |    responder SPI: 96 b9 47 47  d3 fe ee 8b
output: |    next payload type: ISAKMP_NEXT_v2SK (0x2e)
output: |    ISAKMP version: IKEv2 version 2.0 (rfc4306/rfc5996) (0x20)
output: |    exchange type: ISAKMP_v2_IKE_AUTH (0x23)
output: |    flags: ISAKMP_FLAG_v2_MSG_RESPONSE (0x20)
output: |    Message ID: 1 (00 00 00 01)
output: |    length: 225 (00 00 00 e1)
output: |  processing version=2.0 packet with exchange type=ISAKMP_v2_IKE_AUTH (35)
output: | I am the IKE SA Original Initiator receiving an IKEv2 IKE_AUTH response 
output: | State DB: found IKEv2 state #3 in PARENT_I2 (find_v2_ike_sa)
output: | #3 is idle
output: | #3 idle
output: | unpacking clear payload
output: | Now let's proceed with payload (ISAKMP_NEXT_v2SK)
output: | ***parse IKEv2 Encryption Payload:
output: |    next payload type: ISAKMP_NEXT_v2IDr (0x24)
output: |    flags: none (0x0)
output: |    length: 197 (00 c5)
output: | processing payload: ISAKMP_NEXT_v2SK (len=193)
output: | looking for transition from PARENT_I2 matching IKE_AUTH response: SK (ignoring secured payloads)
output: |   trying: Initiator: process IKE_INTERMEDIATE reply, initiate IKE_AUTH or IKE_INTERMEDIATE
output: |     exchange type does not match IKE_INTERMEDIATE
output: |   trying: Initiator: process IKE_AUTH response
output: |     matching by ignoring secured payloads
output: | stripping 1 octets as pad
output: | #3 ikev2 ISAKMP_v2_IKE_AUTH decrypt success
output: | struct msg_digest: addref @0x7f6b701f3708(1->2) (process_packet_with_secured_ike_sa() +2204 programs/pluto/ikev2.c)
output: | Now let's proceed with payload (ISAKMP_NEXT_v2IDr)
output: | **parse IKEv2 Identification - Responder - Payload:
output: |    next payload type: ISAKMP_NEXT_v2AUTH (0x27)
output: |    flags: none (0x0)
output: |    length: 12 (00 0c)
output: |    ID type: ID_FQDN (0x2)
output: |    reserved: 00 00 00
output: | processing payload: ISAKMP_NEXT_v2IDr (len=4)
output: | Now let's proceed with payload (ISAKMP_NEXT_v2AUTH)
output: | **parse IKEv2 Authentication Payload:
output: |    next payload type: ISAKMP_NEXT_v2SA (0x21)
output: |    flags: none (0x0)
output: |    length: 72 (00 48)
output: |    auth method: IKEv2_AUTH_SHARED (0x2)
output: | processing payload: ISAKMP_NEXT_v2AUTH (len=64)
output: | Now let's proceed with payload (ISAKMP_NEXT_v2SA)
output: | **parse IKEv2 Security Association Payload:
output: |    next payload type: ISAKMP_NEXT_v2TSi (0x2c)
output: |    flags: none (0x0)
output: |    length: 36 (00 24)
output: | processing payload: ISAKMP_NEXT_v2SA (len=32)
output: | Now let's proceed with payload (ISAKMP_NEXT_v2TSi)
output: | **parse IKEv2 Traffic Selector - Initiator - Payload:
output: |    next payload type: ISAKMP_NEXT_v2TSr (0x2d)
output: |    flags: none (0x0)
output: |    length: 24 (00 18)
output: |    number of TS: 1 (01)
output: | processing payload: ISAKMP_NEXT_v2TSi (len=16)
output: | Now let's proceed with payload (ISAKMP_NEXT_v2TSr)
output: | **parse IKEv2 Traffic Selector - Responder - Payload:
output: |    next payload type: ISAKMP_NEXT_v2NONE (0x0)
output: |    flags: none (0x0)
output: |    length: 24 (00 18)
output: |    number of TS: 1 (01)
output: | processing payload: ISAKMP_NEXT_v2TSr (len=16)
output: | looking for transition from PARENT_I2 matching IKE_AUTH response: SK{IDr,AUTH,SA,TSi,TSr}
output: |   trying: Initiator: process IKE_INTERMEDIATE reply, initiate IKE_AUTH or IKE_INTERMEDIATE
output: |     exchange type does not match IKE_INTERMEDIATE
output: |   trying: Initiator: process IKE_AUTH response
output: |     secured message matched
output: | selected state microcode Initiator: process IKE_AUTH response
output: | #3.st_v2_transition PARENT_I1->PARENT_I2 -> PARENT_I2->ESTABLISHED_IKE_SA (v2_dispatch() +2308 programs/pluto/ikev2.c)
output: | Message ID: IKE #3 initiator processing response to existing exchange (initiator: .sent=1 .recv=0 .recv_frags=0 .wip=1 .last_sent=13.231451 .last_recv=13.230877 responder: .sent=-1 .recv=-1 .recv_frags=0 .wip=-1 .last_sent=13.005023 .last_recv=13.005023)
output: | calling processor Initiator: process IKE_AUTH response
output: |   #3 spent 1.63 (9.97) milliseconds
output: | no certs to decode
output: | responder ID is ID_FQDN: '@east'
output: | rhc: peer ID matches and no certificate payload - continuing with peer ID @east
output: |     result: newref clone-key@0x7f6b70198f80 (64-bytes, SHA512_HMAC)(init_symkey() +101 lib/libswan/ike_alg_prf_mac_nss_ops.c)
output: | idhash auth R2: delref clone-key@0x7f6b70198f80
output: | initiator verifying AUTH payload
output: | verifying auth payload, remote sent v2AUTH=SHARED we want auth=secret
output: | ikev2_calculate_psk_sighash() called for STATE_V2_PARENT_I2 to REMOTE_PERSPECTIVE PSK with authby=secret
output: | lsw_get_secret() using IDs for @west->@east of kind SECRET_PSK
output: | line 1: key type SECRET_PSK(@west) to type SECRET_PSK
output: | 1: compared key @west to @west / @east -> 8
output: | 2: compared key @east to @west / @east -> c
output: |   match=c
output: |   match c beats previous best_match 0 match=0x7f6b70117f68 (line=1)
output: | concluding with best_match=c best=0x7f6b70117f68 (lineno=1)
output: |     result: newref pss-key@0x7f6b70b00f80 (52-bytes, EXTRACT_KEY_FROM_KEY)(merge_symkey_bytes() +222 lib/libswan/crypt_symkey.c)
output: |     result: newref pss-key@0x7f6b70198f80 (36-bytes, SHA512_HMAC)(psk_auth() +201 lib/libswan/ike_alg_prf_ikev2_nss_ops.c)
output: | pss: delref tmp-key@0x7f6b70b00f80
output: |     result: newref prf(Shared Secret, "Key Pad for IKEv2")-key@0x7f6b70b00f80 (64-bytes, SHA512_HMAC)(psk_auth() +228 lib/libswan/ike_alg_prf_ikev2_nss_ops.c)
output: | psk pss_key: delref pss_key-key@0x7f6b70198f80
output: |     result: newref clone-key@0x7f6b70198f80 (64-bytes, SHA512_HMAC)(init_symkey() +101 lib/libswan/ike_alg_prf_mac_nss_ops.c)
output: | <signed-octets> = prf(<prf-psk>, <msg octets>): delref clone-key@0x7f6b70198f80
output: | psk_auth: delref prf-psk-key@0x7f6b70b00f80
output: "west-east" #3: initiator established IKE SA; authenticated peer using authby=secret and ID_FQDN '@east'
output: | parent state #3: PARENT_I2(open IKE SA) => ESTABLISHED_IKE_SA(established IKE SA)
output: | "west-east": addref @0x7f6b70b9da78(4->5) "west-east" #3:  (dispatch() +2436 programs/pluto/routing.c)
output: | "west-east" #3: routing: start ESTABLISH_IKE, ROUTED_NEGOTIATION, PERMANENT; IKE #3 (ESTABLISHED_IKE_SA) by=PEER; $1@0x7f6b70b9da78; routing_sa #4 negotiating_ike_sa #3 negotiating_child_sa #4 (v2_ike_sa_established() +193 programs/pluto/ikev2_parent.c)
output: | "west-east" #3: routing: stop ESTABLISH_IKE, ROUTED_NEGOTIATION, PERMANENT; ok=yes; routing_sa #4 negotiating_ike_sa #3 established_ike_sa #0->#3 negotiating_child_sa #4 (v2_ike_sa_established() +193 programs/pluto/ikev2_parent.c)
output: | "west-east": delref @0x7f6b70b9da78(5->4) "west-east" #3:  (dispatch() +2450 programs/pluto/routing.c)
output: | pstats #3 ikev2.ike established
output: | redirect: no redirect payload in IKE_AUTH reply
output: | MOBIKE_SUPPORTED neither requested nor accepted
output: | comparing remote proposals against IKE_AUTH initiator accepting remote ESP/AH proposal 5 local proposals
output: | local proposal 1 type ENCR has 1 transforms
output: | local proposal 1 type PRF has 0 transforms
output: | local proposal 1 type INTEG has 1 transforms
output: | local proposal 1 type DH has 1 transforms
output: | local proposal 1 type ESN has 2 transforms
output: | local proposal 1 transforms: required: ENCR+ESN; optional: INTEG+DH
output: | local proposal 2 type ENCR has 1 transforms
output: | local proposal 2 type PRF has 0 transforms
output: | local proposal 2 type INTEG has 1 transforms
output: | local proposal 2 type DH has 1 transforms
output: | local proposal 2 type ESN has 2 transforms
output: | local proposal 2 transforms: required: ENCR+ESN; optional: INTEG+DH
output: | local proposal 3 type ENCR has 1 transforms
output: | local proposal 3 type PRF has 0 transforms
output: | local proposal 3 type INTEG has 1 transforms
output: | local proposal 3 type DH has 1 transforms
output: | local proposal 3 type ESN has 2 transforms
output: | local proposal 3 transforms: required: ENCR+ESN; optional: INTEG+DH
output: | local proposal 4 type ENCR has 1 transforms
output: | local proposal 4 type PRF has 0 transforms
output: | local proposal 4 type INTEG has 2 transforms
output: | local proposal 4 type DH has 1 transforms
output: | local proposal 4 type ESN has 2 transforms
output: | local proposal 4 transforms: required: ENCR+INTEG+ESN; optional: DH
output: | local proposal 5 type ENCR has 1 transforms
output: | local proposal 5 type PRF has 0 transforms
output: | local proposal 5 type INTEG has 2 transforms
output: | local proposal 5 type DH has 1 transforms
output: | local proposal 5 type ESN has 2 transforms
output: | local proposal 5 transforms: required: ENCR+INTEG+ESN; optional: DH
output: | ***parse IKEv2 Proposal Substructure Payload:
output: |    last proposal: v2_PROPOSAL_LAST (0x0)
output: |    length: 32 (00 20)
output: |    prop #: 1 (01)
output: |    proto ID: IKEv2_SEC_PROTO_ESP (0x3)
output: |    spi size: 4 (04)
output: |    # transforms: 2 (02)
output: | parsing 4 raw bytes of IKEv2 Proposal Substructure Payload into remote SPI
output: |   2d ab 18 22                                          -.."
output: | Comparing remote proposal 1 containing 2 transforms against local proposal [1..1] of 5 local proposals
output: | ****parse IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_NON_LAST (0x3)
output: |    length: 12 (00 0c)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ENCR (0x1)
output: |    IKEv2 transform ID: AES_GCM_C (0x14)
output: | *****parse IKEv2 Attribute Substructure Payload:
output: |    af+type: AF+IKEv2_KEY_LENGTH (0x800e)
output: |    length/value: 256 (01 00)
output: | remote proposal 1 transform 0 (ENCR=AES_GCM_C_256) matches local proposal 1 type 1 (ENCR) transform 0
output: | ****parse IKEv2 Transform Substructure Payload:
output: |    last transform: v2_TRANSFORM_LAST (0x0)
output: |    length: 8 (00 08)
output: |    IKEv2 transform type: IKEv2_TRANS_TYPE_ESN (0x5)
output: |    IKEv2 transform ID: IKEv2_ESN_YES (0x1)
output: | remote proposal 1 transform 1 (ESN=YES) matches local proposal 1 type 5 (ESN) transform 0
output: | remote proposal 1 proposed transforms: ENCR+ESN; matched: ENCR+ESN; unmatched: none
output: | comparing remote proposal 1 containing ENCR+ESN transforms to local proposal 1; required: ENCR+ESN; optional: INTEG+DH; matched: ENCR+ESN
output: | remote proposal 1 matches local proposal 1
output: | remote accepted the proposal 1:ESP:ENCR=AES_GCM_C_256;ESN=YES[first-match]
output: | IKE_AUTH initiator accepting remote ESP/AH proposal ikev2_proposal: 1:ESP=AES_GCM_C_256-ESN:YES SPI=2dab1822
output: | converting proposal to internal trans attrs
output: | TSi: parsing 1 traffic selectors
output: | ***parse IKEv2 Traffic Selector Header:
output: |    TS type: IKEv2_TS_IPV4_ADDR_RANGE (0x7)
output: |    IP Protocol ID: ALL (0x0)
output: |    length: 16 (00 10)
output: | ****parse IKEv2 IP Traffic Selector port range:
output: |    start port: 0 (00 00)
output: |    end port: 65535 (ff ff)
output: | parsing 4 raw bytes of IKEv2 Traffic Selector Header into TS IP start
output: |   c0 00 01 00                                          ....
output: | parsing 4 raw bytes of IKEv2 Traffic Selector Header into TS IP end
output: |   c0 00 01 ff                                          ....
output: | TSi: parsed 1 traffic selectors
output: | TSr: parsing 1 traffic selectors
output: | ***parse IKEv2 Traffic Selector Header:
output: |    TS type: IKEv2_TS_IPV4_ADDR_RANGE (0x7)
output: |    IP Protocol ID: ALL (0x0)
output: |    length: 16 (00 10)
output: | ****parse IKEv2 IP Traffic Selector port range:
output: |    start port: 0 (00 00)
output: |    end port: 65535 (ff ff)
output: | parsing 4 raw bytes of IKEv2 Traffic Selector Header into TS IP start
output: |   c0 00 02 00                                          ....
output: | parsing 4 raw bytes of IKEv2 Traffic Selector Header into TS IP end
output: |   c0 00 02 ff                                          ....
output: | TSr: parsed 1 traffic selectors
output: | ts: evaluating END EQUALS:
output: | ts:   narrow port: selector.port=0..65535 EQUALS TSi[1]=0..65535 ==> 0..65535(0) (must match)
output: | ts:   narrow protocol: selector.ipproto=*0 EQUALS TSi[1]=*0 ==> ALL (must match)
output: | ts:   narrow range: selector.range=192.0.1.0-192.0.1.255 EQUALS TSi[1]=192.0.1.0-192.0.1.255 ==> 192.0.1.0-192.0.1.255 (must match)
output: | ts:     narrowed TSi[1] address-range 192.0.1.0-192.0.1.255 has fitness 25
output: | ts:     narrowed TSi[1] port 0 has fitness 65536
output: | ts:     narrowed TSi[1] protocol ALL has fitness 255
output: | ts:   narrow port: selector.port=0..65535 EQUALS TSr[1]=0..65535 ==> 0..65535(0) (must match)
output: | ts:   narrow protocol: selector.ipproto=*0 EQUALS TSr[1]=*0 ==> ALL (must match)
output: | ts:   narrow range: selector.range=192.0.2.0-192.0.2.255 EQUALS TSr[1]=192.0.2.0-192.0.2.255 ==> 192.0.2.0-192.0.2.255 (must match)
output: | ts:     narrowed TSr[1] address-range 192.0.2.0-192.0.2.255 has fitness 25
output: | ts:     narrowed TSr[1] port 0 has fitness 65536
output: | ts:     narrowed TSr[1] protocol ALL has fitness 255
output: | skipping scribble as already scribbled
output: | skipping scribble as already scribbled
output: | accepted selectors [192.0.1.0/24]->[192.0.2.0/24]
output: | allocating 1 SPDs
output: | left.child.has_client: yes -> yes (scribble_ts_response_on_initiator() +285 programs/pluto/ikev2_ts.c)
output: | right.child.has_client: yes -> yes (scribble_ts_response_on_initiator() +287 programs/pluto/ikev2_ts.c)
output: | USE_TRANSPORT_MODE neither requested nor accepted
output: | local policy is Tunnel Mode and received matching notify
output: | integ=NONE: .key_size=0 encrypt=AES_GCM_16: .key_size=32 .salt_size=4 keymat_len=36
output: |     result: newref keymat-key@0x7f6b70b00f80 (72-bytes, EXTRACT_KEY_FROM_KEY)(prfplus_key_data() +61 lib/libswan/ike_alg_prf_ikev2_nss_ops.c)
output: |     result: newref initiator to responder key-key@0x7f6b70198f80 (36-bytes, EXTRACT_KEY_FROM_KEY)(ikev2_derive_child_keys() +126 programs/pluto/ikev2_crypto.c)
output: | initiator to responder keys: newref slot-key@0x7f6b70c06f80 (36-bytes, EXTRACT_KEY_FROM_KEY)
output: | initiator to responder keys: delref slot-key-key@0x7f6b70c06f80
output: | ikev2_derive_child_keys: delref ikey-key@0x7f6b70198f80
output: |     result: newref responder to initiator key-key@0x7f6b70198f80 (36-bytes, EXTRACT_KEY_FROM_KEY)(ikev2_derive_child_keys() +133 programs/pluto/ikev2_crypto.c)
output: | responder to initiator keys:: newref slot-key@0x7f6b70c06f80 (36-bytes, EXTRACT_KEY_FROM_KEY)
output: | responder to initiator keys:: delref slot-key-key@0x7f6b70c06f80
output: | ikev2_derive_child_keys: delref rkey-key@0x7f6b70198f80
output: | ikev2_derive_child_keys: delref keymat-key@0x7f6b70b00f80
output: | "west-east": addref @0x7f6b70b9da78(4->5) "west-east" #4:  (dispatch() +2436 programs/pluto/routing.c)
output: | "west-east" #4: routing: start ESTABLISH_INBOUND, ROUTED_NEGOTIATION, PERMANENT; IKE #3 (ESTABLISHED_IKE_SA) Child #4 (IKE_AUTH_CHILD_I0) by=PEER; $1@0x7f6b70b9da78; routing_sa #4 negotiating_ike_sa #3 established_ike_sa #3 negotiating_child_sa #4 (process_v2_child_response_payloads() +838 programs/pluto/ikev2_child.c)
output: | kernel: install_inbound_ipsec_sa() for #4: inbound (process_v2_child_response_payloads() +838 programs/pluto/ikev2_child.c)
output: | checking west-east for conflicts
output: | spd_owner() looking for SPD owner of 192.0.1.0/24===192.0.2.0/24 with routing >= ROUTED_INBOUND_NEGOTIATION[NEGOTIATION]
output: | FOR_EACH_SPD_ROUTE[remote_client_range=192.0.2.0/24]... in (install_inbound_ipsec_sa() +1986 programs/pluto/kernel.c)
output: |   found "west-east" 192.0.1.0/24===192.0.2.0/24
output: |    "west-east" 192.0.1.0/24===192.0.2.0/24 ROUTED_NEGOTIATION[NEGOTIATION] skipped; ignoring self
output: |   matches: 1
output: | spd_owner: owners of 192.0.1.0/24===192.0.2.0/24 routing >= ROUTED_INBOUND_NEGOTIATION[NEGOTIATION]
output: | initiator ipsec-max-bytes: hard-limit=9223372036854775808 soft-limit=4611686018427387900 softer-limit=2305843009213693950 fuzz=154601264970847434 actual-limit=2460444274184541384
output: | initiator ipsec-max-packets: hard-limit=9223372036854775808 soft-limit=4611686018427387900 softer-limit=2305843009213693950 fuzz=419297098130976651 actual-limit=2725140107344670601
output: | kernel: setup_half_kernel_state() INBOUND <unset-selector>->[192.1.2.23=TUNNEL=>192.1.2.45]-><unset-selector> sec_label=
output: | kernel: looking for alg with encrypt: AES_GCM_16 keylen: 256 integ: NONE
output: | encrypt AES_GCM_16 keylen=256 transid=20, key_size=32, encryptalg=20
output: | kernel: AES_GCM_16 requires 4 salt bytes
output: | kernel: child->sa.st_esp.keymat_len=36 is encrypt_keymat_size=36 + integ_keymat_size=0
output: | kernel: setting IPsec SA replay-window to 128
output: | kernel: Enabling ESN
output: | kernel: NIC esp-hw-offload disabled for connection 'west-east'
output: | "west-east" #4: routing:  kernel_ops_add_sa() level=0 INBOUND TUNNEL
output: | "west-east" #4: routing:   (src) <unset-selector> -> 192.1.2.23[6274be95] ==> 192.1.2.45 -> <unset-selector> (dst)
output: | "west-east" #4: routing:   NONE:0 AES_GCM_16:36 replay_window=128 +esn +dont_encap_dscp ...
output: | netlink_add_sa() tunnel enabling inner-most tunnel mode
output: | netlink_add_sa() adding IPsec SA with reqid 16389
output: | netlink_add_sa() enabling ESN
output: | netlink_add_sa() disabling Encap DSCP
output: | netlink_add_sa() setting IPsec SA replay-window to 128 using xfrm_replay_state_esn
output: | netlink_add_sa() esp-hw-offload not set for IPsec SA
output: | sendrecv_xfrm_msg() sending 26 Add SA esp.ESPSPIi@192.1.2.45
output: | sendrecv_xfrm_msg() recvfrom() returned 36 bytes
output: | sendrecv_xfrm_msg() netlink response for Add SA esp.ESPSPIi@192.1.2.45 included non-error error
output: | "west-east" #4: routing:   ... yes
output: | kernel: install_inbound_ipsec_kernel_policies() owner=#4
output: | kernel: install_inbound_ipsec_kernel_policies() is installing SPD for 192.0.2.0/24=>192.0.1.0/24
output: | kernel: NIC esp-hw-offload disabled for connection 'west-east'
output: | priority calculation of is 1757393 (0x1ad0d1) base=1 portsw=2 protow=1, srcw=104 dstw=104 instw=1
output: | kernel: install_inbound_ipsec_kernel_policy() is installing SPD for 192.0.2.0/24=>192.0.1.0/24
output: | "west-east" #4: routing:  kernel_ops_policy_add() ADD+INBOUND add inbound Child SA (install_inbound_ipsec_kernel_policies() +1636 programs/pluto/kernel.c)
output: | "west-east" #4: routing:   client=192.0.2.0/24=>192.0.1.0/24 lifetime=0s
output: | "west-east" #4: routing:   sa_marks=out:0/00000000,in:0/00000000
output: | "west-east" #4: routing:   policy=192.1.2.23=>192.1.2.45,IPSEC=IPSEC,priority=1757393,TUNNEL[ESP@16389(ALL)]
output: | kernel_ops_policy_add()   policy=IPv4 action=0 xfrm_dir=0 op=ADD dir=INBOUND
output: | kernel_xfrm_policy_add() using family IPv4 (2)
output: | set_xfrm_selectors() using family IPv4 (2)
output: | kernel_xfrm_policy_add() IPsec SA SPD priority set to 1757393
output: | kernel_xfrm_policy_add() adding xfrm_user_tmpl reqid=16389 id.proto=50 optional=0 family=2 mode=1 saddr=192.1.2.23 daddr=192.1.2.45
output: | sendrecv_xfrm_msg() sending 25 policy IPv4
output: | sendrecv_xfrm_msg() recvfrom() returned 36 bytes
output: | kernel_ops_policy_add()   XFRM_MSG_UPDPOLICY for flow IPv4 (in) had A policy
output: | kernel_xfrm_policy_add() adding policy forward (suspect a tunnel)
output: | sendrecv_xfrm_msg() sending 25 policy IPv4
output: | sendrecv_xfrm_msg() recvfrom() returned 36 bytes
output: | kernel_ops_policy_add()   XFRM_MSG_UPDPOLICY for flow IPv4 (fwd) had A policy
output: | "west-east" #4: routing:   ... yes
output: | "west-east" #4: routing: stop ESTABLISH_INBOUND, ROUTED_NEGOTIATION->ROUTED_INBOUND_NEGOTIATION, PERMANENT; ok=yes; routing_sa #4 negotiating_ike_sa #3 established_ike_sa #3 negotiating_child_sa #4 (process_v2_child_response_payloads() +838 programs/pluto/ikev2_child.c)
output: | "west-east": delref @0x7f6b70b9da78(5->4) "west-east" #4:  (dispatch() +2450 programs/pluto/routing.c)
output: | "west-east": addref @0x7f6b70b9da78(4->5) "west-east" #4:  (dispatch() +2436 programs/pluto/routing.c)
output: | "west-east" #4: routing: start ESTABLISH_OUTBOUND, ROUTED_INBOUND_NEGOTIATION, PERMANENT; IKE #3 (ESTABLISHED_IKE_SA) Child #4 (IKE_AUTH_CHILD_I0) by=PEER; $1@0x7f6b70b9da78; routing_sa #4 negotiating_ike_sa #3 established_ike_sa #3 negotiating_child_sa #4 (process_v2_child_response_payloads() +838 programs/pluto/ikev2_child.c)
output: | kernel: install_outbound_ipsec_sa() for #4: outbound (process_v2_child_response_payloads() +838 programs/pluto/ikev2_child.c)
output: | initiator ipsec-max-bytes: hard-limit=9223372036854775808 soft-limit=4611686018427387900 softer-limit=2305843009213693950 fuzz=175008375366505539 actual-limit=2480851384580199489
output: | initiator ipsec-max-packets: hard-limit=9223372036854775808 soft-limit=4611686018427387900 softer-limit=2305843009213693950 fuzz=474973423513469090 actual-limit=2780816432727163040
output: | kernel: setup_half_kernel_state() OUTBOUND <unset-selector>->[192.1.2.45=TUNNEL=>192.1.2.23]-><unset-selector> sec_label=
output: | kernel: looking for alg with encrypt: AES_GCM_16 keylen: 256 integ: NONE
output: | encrypt AES_GCM_16 keylen=256 transid=20, key_size=32, encryptalg=20
output: | kernel: AES_GCM_16 requires 4 salt bytes
output: | kernel: child->sa.st_esp.keymat_len=36 is encrypt_keymat_size=36 + integ_keymat_size=0
output: | kernel: setting IPsec SA replay-window to 128
output: | kernel: Enabling ESN
output: | kernel: NIC esp-hw-offload disabled for connection 'west-east'
output: | "west-east" #4: routing:  kernel_ops_add_sa() level=0 OUTBOUND TUNNEL
output: | "west-east" #4: routing:   (src) <unset-selector> -> 192.1.2.45[2dab1822] ==> 192.1.2.23 -> <unset-selector> (dst)
output: | "west-east" #4: routing:   NONE:0 AES_GCM_16:36 replay_window=128 +esn +dont_encap_dscp ...
output: | netlink_add_sa() tunnel enabling inner-most tunnel mode
output: | netlink_add_sa() adding IPsec SA with reqid 16389
output: | netlink_add_sa() enabling ESN
output: | netlink_add_sa() disabling Encap DSCP
output: | netlink_add_sa() setting IPsec SA replay-window to 128 using xfrm_replay_state_esn
output: | netlink_add_sa() esp-hw-offload not set for IPsec SA
output: | sendrecv_xfrm_msg() sending 16 Add SA esp.ESPSPIi@192.1.2.23
output: | sendrecv_xfrm_msg() recvfrom() returned 36 bytes
output: | sendrecv_xfrm_msg() netlink response for Add SA esp.ESPSPIi@192.1.2.23 included non-error error
output: | "west-east" #4: routing:   ... yes
output: | kernel: install_outbound_ipsec_kernel_policies() installing IPsec policies for #4: connection is currently #4 RT_ROUTED_INBOUND_NEGOTIATION route=no up=yes
output: | spd_owner() looking for SPD owner of 192.0.1.0/24===192.0.2.0/24 with routing >= ROUTED_TUNNEL[IPSEC]
output: | FOR_EACH_SPD_ROUTE[remote_client_range=192.0.2.0/24]... in (get_connection_spd_conflict() +793 programs/pluto/kernel.c)
output: |   found "west-east" 192.0.1.0/24===192.0.2.0/24
output: |    "west-east" 192.0.1.0/24===192.0.2.0/24 ROUTED_INBOUND_NEGOTIATION[NEGOTIATION] skipped; ignoring self
output: |   matches: 1
output: | spd_owner: owners of 192.0.1.0/24===192.0.2.0/24 routing >= ROUTED_TUNNEL[IPSEC]
output: | kernel: get_connection_spd_conflict looking for 192.0.1.0/24===192.0.2.0/24
output: | kernel: NIC esp-hw-offload disabled for connection 'west-east'
output: | priority calculation of is 1757393 (0x1ad0d1) base=1 portsw=2 protow=1, srcw=104 dstw=104 instw=1
output: | "west-east" #4: routing:  kernel_ops_policy_add() ADD+OUTBOUND install IPsec policy (install_outbound_ipsec_kernel_policies() +1844 programs/pluto/kernel.c)
output: | "west-east" #4: routing:   client=192.0.1.0/24=>192.0.2.0/24 lifetime=0s
output: | "west-east" #4: routing:   sa_marks=out:0/00000000,in:0/00000000
output: | "west-east" #4: routing:   policy=192.1.2.45=>192.1.2.23,IPSEC=IPSEC,priority=1757393,TUNNEL[ESP@16389(ALL)]
output: | kernel_ops_policy_add()   policy=IPv4 action=0 xfrm_dir=1 op=ADD dir=OUTBOUND
output: | kernel_xfrm_policy_add() using family IPv4 (2)
output: | set_xfrm_selectors() using family IPv4 (2)
output: | kernel_xfrm_policy_add() IPsec SA SPD priority set to 1757393
output: | kernel_xfrm_policy_add() adding xfrm_user_tmpl reqid=16389 id.proto=50 optional=0 family=2 mode=1 saddr=192.1.2.45 daddr=192.1.2.23
output: | sendrecv_xfrm_msg() sending 25 policy IPv4
output: | sendrecv_xfrm_msg() recvfrom() returned 36 bytes
output: | kernel_ops_policy_add()   XFRM_MSG_UPDPOLICY for flow IPv4 (out) had A policy
output: | "west-east" #4: routing:   ... yes
output: | kernel: running updown command "ipsec _updown" for verb prepare 
output: | kernel: command executing prepare-client
output: | kernel: get_ipsec_traffic() esp.ESPSPIi@192.1.2.45
output: | sendrecv_xfrm_msg() sending 18 Get SA esp.ESPSPIi@192.1.2.45
output: | sendrecv_xfrm_msg() recvfrom() returned 404 bytes
output: | xfrm_get_kernel_state() rtattribute type 24 ...
output: | xfrm_get_kernel_state() rtattribute type 18 ...
output: | xfrm_get_kernel_state() rtattribute type 23 ...
output: | kernel: get_ipsec_traffic() bytes=0 add_time=1709007346 lastused=0
output: | kernel: get_ipsec_traffic() esp.ESPSPIi@192.1.2.23
output: | sendrecv_xfrm_msg() sending 18 Get SA esp.ESPSPIi@192.1.2.23
output: | sendrecv_xfrm_msg() recvfrom() returned 404 bytes
output: | xfrm_get_kernel_state() rtattribute type 24 ...
output: | xfrm_get_kernel_state() rtattribute type 18 ...
output: | xfrm_get_kernel_state() rtattribute type 23 ...
output: | kernel: get_ipsec_traffic() bytes=0 add_time=1709007346 lastused=0
output: | executing prepare-client: 2>&1 PLUTO_VERB='prepare-client' PLUTO_CONNECTION='west-east' PLUTO_CONNECTION_TYPE='tunnel' PLUTO_VIRT_INTERFACE='NULL' PLUTO_INTERFACE='eth1' PLUTO_XFRMI_ROUTE='' PLUTO_NEXT_HOP='192.1.2.23' PLUTO_ME='192.1.2.45' PLUTO_MY_ID='@west' PLUTO_CLIENT_FAMILY='ipv4' PLUTO_MY_CLIENT='192.0.1.0/24' PLUTO_MY_CLIENT_NET='192.0.1.0' PLUTO_MY_CLIENT_MASK='255.255.255.0' PLUTO_MY_PORT=0 PLUTO_MY_PROTOCOL=0 PLUTO_SA_REQID=16389 PLUTO_SA_TYPE='ESP' PLUTO_PEER='192.1.2.23' PLUTO_PEER_ID='@east' PLUTO_PEER_CLIENT='192.0.2.0/24' PLUTO_PEER_CLIENT_NET='192.0.2.0' PLUTO_PEER_CLIENT_MASK='255.255.255.0' PLUTO_PEER_PORT=0 PLUTO_PEER_PROTOCOL=0 PLUTO_PEER_CA='' PLUTO_STACK='xfrm' PLUTO_ADDTIME=0 PLUTO_CONN_POLICY='IKEv2+PSK+ENCRYPT+TUNNEL+PFS+ROUTE+UP+IKE_FRAG_ALLOW+ESN_NO+ESN_YES' PLUTO_CONN_KIND='CK_PERMANENT' PLUTO_CONN_ADDRFAMILY='ipv4' XAUTH_FAILED=0 PLUTO_IS_PEER_CISCO=0 PLUTO_PEER_DNS_INFO='' PLUTO_PEER_DOMAIN_INFO='' PLUTO_PEER_BANNER='' PLUTO_CFG_SERVER=0 PLUTO_CFG_CLIENT=0 PLUTO_NM_CONFIG...
output: | popen cmd is 1127 chars long
output: | cmd(   0):2>&1 PLUTO_VERB='prepare-client' PLUTO_CONNECTION='west-east' PLUTO_CONNECTION_T:
output: | cmd(  80):YPE='tunnel' PLUTO_VIRT_INTERFACE='NULL' PLUTO_INTERFACE='eth1' PLUTO_XFRMI_ROUT:
output: | cmd( 160):E='' PLUTO_NEXT_HOP='192.1.2.23' PLUTO_ME='192.1.2.45' PLUTO_MY_ID='@west' PLUTO:
output: | cmd( 240):_CLIENT_FAMILY='ipv4' PLUTO_MY_CLIENT='192.0.1.0/24' PLUTO_MY_CLIENT_NET='192.0.:
output: | cmd( 320):1.0' PLUTO_MY_CLIENT_MASK='255.255.255.0' PLUTO_MY_PORT=0 PLUTO_MY_PROTOCOL=0 PL:
output: | cmd( 400):UTO_SA_REQID=16389 PLUTO_SA_TYPE='ESP' PLUTO_PEER='192.1.2.23' PLUTO_PEER_ID='@e:
output: | cmd( 480):ast' PLUTO_PEER_CLIENT='192.0.2.0/24' PLUTO_PEER_CLIENT_NET='192.0.2.0' PLUTO_PE:
output: | cmd( 560):ER_CLIENT_MASK='255.255.255.0' PLUTO_PEER_PORT=0 PLUTO_PEER_PROTOCOL=0 PLUTO_PEE:
output: | cmd( 640):R_CA='' PLUTO_STACK='xfrm' PLUTO_ADDTIME=0 PLUTO_CONN_POLICY='IKEv2+PSK+ENCRYPT+:
output: | cmd( 720):TUNNEL+PFS+ROUTE+UP+IKE_FRAG_ALLOW+ESN_NO+ESN_YES' PLUTO_CONN_KIND='CK_PERMANENT:
output: | cmd( 800):' PLUTO_CONN_ADDRFAMILY='ipv4' XAUTH_FAILED=0 PLUTO_IS_PEER_CISCO=0 PLUTO_PEER_D:
output: | cmd( 880):NS_INFO='' PLUTO_PEER_DOMAIN_INFO='' PLUTO_PEER_BANNER='' PLUTO_CFG_SERVER=0 PLU:
output: | cmd( 960):TO_CFG_CLIENT=0 PLUTO_NM_CONFIGURED=0 PLUTO_INBYTES=0 PLUTO_OUTBYTES=0 VTI_IFACE:
output: | cmd(1040):='' VTI_ROUTING='no' VTI_SHARED='no' SPI_IN=0x2dab1822 SPI_OUT=0x6274be95 ipsec :
output: | cmd(1120):_updown:
output: | kernel: install_outbound_ipsec_kernel_policies() skipping updown-route as non-bare
output: | kernel: running updown command "ipsec _updown" for verb up 
output: | kernel: command executing up-client
output: | kernel: get_ipsec_traffic() esp.ESPSPIi@192.1.2.45
output: | sendrecv_xfrm_msg() sending 18 Get SA esp.ESPSPIi@192.1.2.45
output: | sendrecv_xfrm_msg() recvfrom() returned 404 bytes
output: | xfrm_get_kernel_state() rtattribute type 24 ...
output: | xfrm_get_kernel_state() rtattribute type 18 ...
output: | xfrm_get_kernel_state() rtattribute type 23 ...
output: | kernel: get_ipsec_traffic() bytes=0 add_time=1709007346 lastused=0
output: | kernel: get_ipsec_traffic() esp.ESPSPIi@192.1.2.23
output: | sendrecv_xfrm_msg() sending 18 Get SA esp.ESPSPIi@192.1.2.23
output: | sendrecv_xfrm_msg() recvfrom() returned 404 bytes
output: | xfrm_get_kernel_state() rtattribute type 24 ...
output: | xfrm_get_kernel_state() rtattribute type 18 ...
output: | xfrm_get_kernel_state() rtattribute type 23 ...
output: | kernel: get_ipsec_traffic() bytes=0 add_time=1709007346 lastused=0
output: | executing up-client: 2>&1 PLUTO_VERB='up-client' PLUTO_CONNECTION='west-east' PLUTO_CONNECTION_TYPE='tunnel' PLUTO_VIRT_INTERFACE='NULL' PLUTO_INTERFACE='eth1' PLUTO_XFRMI_ROUTE='' PLUTO_NEXT_HOP='192.1.2.23' PLUTO_ME='192.1.2.45' PLUTO_MY_ID='@west' PLUTO_CLIENT_FAMILY='ipv4' PLUTO_MY_CLIENT='192.0.1.0/24' PLUTO_MY_CLIENT_NET='192.0.1.0' PLUTO_MY_CLIENT_MASK='255.255.255.0' PLUTO_MY_PORT=0 PLUTO_MY_PROTOCOL=0 PLUTO_SA_REQID=16389 PLUTO_SA_TYPE='ESP' PLUTO_PEER='192.1.2.23' PLUTO_PEER_ID='@east' PLUTO_PEER_CLIENT='192.0.2.0/24' PLUTO_PEER_CLIENT_NET='192.0.2.0' PLUTO_PEER_CLIENT_MASK='255.255.255.0' PLUTO_PEER_PORT=0 PLUTO_PEER_PROTOCOL=0 PLUTO_PEER_CA='' PLUTO_STACK='xfrm' PLUTO_ADDTIME=1709007346 PLUTO_CONN_POLICY='IKEv2+PSK+ENCRYPT+TUNNEL+PFS+ROUTE+UP+IKE_FRAG_ALLOW+ESN_NO+ESN_YES' PLUTO_CONN_KIND='CK_PERMANENT' PLUTO_CONN_ADDRFAMILY='ipv4' XAUTH_FAILED=0 PLUTO_IS_PEER_CISCO=0 PLUTO_PEER_DNS_INFO='' PLUTO_PEER_DOMAIN_INFO='' PLUTO_PEER_BANNER='' PLUTO_CFG_SERVER=0 PLUTO_CFG_CLIENT=0 PLUTO_NM_CONFIGU...
output: | popen cmd is 1131 chars long
output: | cmd(   0):2>&1 PLUTO_VERB='up-client' PLUTO_CONNECTION='west-east' PLUTO_CONNECTION_TYPE=':
output: | cmd(  80):tunnel' PLUTO_VIRT_INTERFACE='NULL' PLUTO_INTERFACE='eth1' PLUTO_XFRMI_ROUTE='' :
output: | cmd( 160):PLUTO_NEXT_HOP='192.1.2.23' PLUTO_ME='192.1.2.45' PLUTO_MY_ID='@west' PLUTO_CLIE:
output: | cmd( 240):NT_FAMILY='ipv4' PLUTO_MY_CLIENT='192.0.1.0/24' PLUTO_MY_CLIENT_NET='192.0.1.0' :
output: | cmd( 320):PLUTO_MY_CLIENT_MASK='255.255.255.0' PLUTO_MY_PORT=0 PLUTO_MY_PROTOCOL=0 PLUTO_S:
output: | cmd( 400):A_REQID=16389 PLUTO_SA_TYPE='ESP' PLUTO_PEER='192.1.2.23' PLUTO_PEER_ID='@east' :
output: | cmd( 480):PLUTO_PEER_CLIENT='192.0.2.0/24' PLUTO_PEER_CLIENT_NET='192.0.2.0' PLUTO_PEER_CL:
output: | cmd( 560):IENT_MASK='255.255.255.0' PLUTO_PEER_PORT=0 PLUTO_PEER_PROTOCOL=0 PLUTO_PEER_CA=:
output: | cmd( 640):'' PLUTO_STACK='xfrm' PLUTO_ADDTIME=1709007346 PLUTO_CONN_POLICY='IKEv2+PSK+ENCR:
output: | cmd( 720):YPT+TUNNEL+PFS+ROUTE+UP+IKE_FRAG_ALLOW+ESN_NO+ESN_YES' PLUTO_CONN_KIND='CK_PERMA:
output: | cmd( 800):NENT' PLUTO_CONN_ADDRFAMILY='ipv4' XAUTH_FAILED=0 PLUTO_IS_PEER_CISCO=0 PLUTO_PE:
output: | cmd( 880):ER_DNS_INFO='' PLUTO_PEER_DOMAIN_INFO='' PLUTO_PEER_BANNER='' PLUTO_CFG_SERVER=0:
output: | cmd( 960): PLUTO_CFG_CLIENT=0 PLUTO_NM_CONFIGURED=0 PLUTO_INBYTES=0 PLUTO_OUTBYTES=0 VTI_I:
output: | cmd(1040):FACE='' VTI_ROUTING='no' VTI_SHARED='no' SPI_IN=0x2dab1822 SPI_OUT=0x6274be95 ip:
output: | cmd(1120):sec _updown:
output: "west-east" #4: IMPAIR: kernel: install_ipsec_sa_outbound_policy in install_outbound_ipsec_kernel_policies()
output: | "west-east" #4: routing: stop ESTABLISH_OUTBOUND, ROUTED_INBOUND_NEGOTIATION->ROUTED_TUNNEL, PERMANENT; ok=no; routing_sa #4 negotiating_ike_sa #3 established_ike_sa #3 negotiating_child_sa #4 established_child_sa #0->#4 (process_v2_child_response_payloads() +838 programs/pluto/ikev2_child.c)
output: | "west-east": delref @0x7f6b70b9da78(5->4) "west-east" #4:  (dispatch() +2450 programs/pluto/routing.c)
output: "west-east" #4: CHILD SA encountered fatal error: INVALID_SYNTAX
output: | #3 complete_v2_state_transition() in state ESTABLISHED_IKE_SA PARENT_I2->ESTABLISHED_IKE_SA with status STF_FATAL
output: "west-east" #3: encountered fatal error in state STATE_V2_ESTABLISHED_IKE_SA
output: | Message ID: IKE #3 forcing a response received update (STF_FATAL) (initiator: .sent=1 .recv=0 .recv_frags=0 .wip=1 .last_sent=13.231451 .last_recv=13.230877 responder: .sent=-1 .recv=-1 .recv_frags=0 .wip=-1 .last_sent=13.005023 .last_recv=13.005023)
output: | Message ID: IKE #3 clearing EVENT_RETRANSMIT as response received (initiator: .sent=1 .recv=0 .recv_frags=0 .wip=-1 .last_sent=13.231451 .last_recv=13.230877 responder: .sent=-1 .recv=-1 .recv_frags=0 .wip=-1 .last_sent=13.005023 .last_recv=13.005023)
output: | #3 requesting EVENT_RETRANSMIT-event@0x7f6b70ba7fa8 be deleted (clear_retransmits() +108 programs/pluto/retransmit.c)
output: | #3 deleting EVENT_RETRANSMIT
output: | tt: delref @0x7f6b70036f68(1->0) (destroy_timeout() +575 programs/pluto/server.c)
output: | state-event: delref @0x7f6b70ba7fa8(1->0) (clear_retransmits() +108 programs/pluto/retransmit.c)
output: | #3 STATE_V2_ESTABLISHED_IKE_SA: retransmits: cleared
output: | Message ID: IKE #3 updating initiator received message response 1 (initiator: .recv=0->1 .wip=1->-1 .last_recv=13.230877->13.381919 responder:)
output: | Message ID: IKE #3 skipping update_send as nothing to send (presumably intiator receiving a response) (initiator: .sent=1 .recv=1 .recv_frags=0 .wip=-1 .last_sent=13.231451 .last_recv=13.381919 responder: .sent=-1 .recv=-1 .recv_frags=0 .wip=-1 .last_sent=13.005023 .last_recv=13.005023)
output: | "west-east" #3: .st_on_delete.skip_send_delete no->true (complete_v2_state_transition() +2822 programs/pluto/ikev2.c)
output: | "west-east" #3: routing:   connection_zap_ike_family()
output: |   IKE SA is no longer viable
output: | "west-east" #3: routing:     dispatching delete to Child SA #4
output: | "west-east" #4: no whack to attach
output: | clone logger: newref @0x7f6b70036fc8(0->1) (teardown_child() +1217 programs/pluto/routing.c)
output: | "west-east": addref @0x7f6b70b9da78(4->5) "west-east" #4:  (dispatch() +2436 programs/pluto/routing.c)
output: | "west-east" #4: routing: start TEARDOWN_CHILD, ROUTED_TUNNEL, PERMANENT; Child #4 (IKE_AUTH_CHILD_I0) by=UNKNOWN; $1@0x7f6b70b9da78; routing_sa #4 negotiating_ike_sa #3 established_ike_sa #3 negotiating_child_sa #4 established_child_sa #4 (complete_v2_state_transition() +2823 programs/pluto/ikev2.c)
output: | "west-east" #4: routing:   Child SA matches .routing_sa
output: | revival: skip update_remote_port(), not an instance
output: "west-east" #4: connection is supposed to remain up; revival attempt 2 scheduled in 5 seconds
output: | string logger: newref @0x7f6b70003fc8(0->1) (schedule_connection_event() +44 programs/pluto/connection_event.c)
output: | "west-east": addref @0x7f6b70b9da78(5->6) event CONNECTION_REVIVAL for "west-east":  (schedule_connection_event() +49 programs/pluto/connection_event.c)
output: "west-east" #4: IMPAIR: revival: skip scheduling revival event
output: | spd_owner() looking for SPD owner of 192.0.1.0/24===192.0.2.0/24 with routing >= ROUTED_ONDEMAND[ONDEMAND]
output: | FOR_EACH_SPD_ROUTE[remote_client_range=192.0.2.0/24]... in (complete_v2_state_transition() +2823 programs/pluto/ikev2.c)
output: |   found "west-east" 192.0.1.0/24===192.0.2.0/24
output: |    "west-east" 192.0.1.0/24===192.0.2.0/24 ROUTED_TUNNEL[IPSEC] skipped; ignoring self
output: |   matches: 1
output: | spd_owner: owners of 192.0.1.0/24===192.0.2.0/24 routing >= ROUTED_ONDEMAND[ONDEMAND]
output: | kernel: NIC esp-hw-offload disabled for connection 'west-east'
output: | priority calculation of is 1757393 (0x1ad0d1) base=1 portsw=2 protow=1, srcw=104 dstw=104 instw=1
output: | "west-east" #4: routing:  kernel_ops_policy_add() REPLACE+OUTBOUND replacing (complete_v2_state_transition() +2823 programs/pluto/ikev2.c)
output: | "west-east" #4: routing:   client=192.0.1.0/24=>192.0.2.0/24 lifetime=0s
output: | "west-east" #4: routing:   sa_marks=out:0/00000000,in:0/00000000
output: | "west-east" #4: routing:   policy=0.0.0.0=>0.0.0.0,ONDEMAND=TRAP,priority=1757393,TRANSPORT[ESP@0(ALL)]
output: | kernel_ops_policy_add()   policy=%trap(allow) action=0 xfrm_dir=1 op=REPLACE dir=OUTBOUND
output: | kernel_xfrm_policy_add() using family IPv4 (2)
output: | set_xfrm_selectors() using family IPv4 (2)
output: | kernel_xfrm_policy_add() IPsec SA SPD priority set to 1757393
output: | kernel_xfrm_policy_add() adding xfrm_user_tmpl reqid=0 id.proto=50 optional=0 family=2 mode=0 saddr=<unset-address> daddr=<unset-address>
output: | sendrecv_xfrm_msg() sending 25 policy %trap(allow)
output: | sendrecv_xfrm_msg() recvfrom() returned 36 bytes
output: | kernel_ops_policy_add()   XFRM_MSG_UPDPOLICY for flow %trap(allow) (out) had A policy
output: | "west-east" #4: routing:   ... yes
output: | "west-east" #4: routing:  kernel_ops_policy_del() INBOUND REPORT_NO_INBOUND inbound (complete_v2_state_transition() +2823 programs/pluto/ikev2.c)
output: | "west-east" #4: routing:   client=192.0.2.0/24=>192.0.1.0/24
output: | "west-east" #4: routing:   sa_marks=out:0/00000000,in:0/00000000
output: | kernel_xfrm_policy_del() using family IPv4 (2)
output: | set_xfrm_selectors() using family IPv4 (2)
output: | sendrecv_xfrm_msg() sending 20 policy delete
output: | sendrecv_xfrm_msg() recvfrom() returned 36 bytes
output: | kernel_ops_policy_del()   XFRM_MSG_DELPOLICY for flow delete (in) had A policy
output: | kernel_xfrm_policy_del() deleting policy forward (even when there may not be one)
output: | sendrecv_xfrm_msg() sending 20 policy delete
output: | sendrecv_xfrm_msg() recvfrom() returned 36 bytes
output: | kernel_ops_policy_del()   XFRM_MSG_DELPOLICY for flow delete (fwd) had A policy
output: | "west-east" #4: routing:   ... yes
output: | "west-east" #4: .st_on_delete.skip_send_delete no->true (delete_child_sa() +758 programs/pluto/state.c)
output: | "west-east" #4: delete_state() skipping log_message:no
output: | pstats #4 ikev2.child deleted other
output: | #4 main thread spent 0 (0) milliseconds helper thread spent 0 (0) milliseconds in total
output: | suspend: no MD saved in state #4 (delete_state() +973 programs/pluto/state.c)
output: | #4 STATE_V2_IKE_AUTH_CHILD_I0: retransmits: cleared
output: | kernel: uninstall_kernel_state() deleting OUTBOUND
output: | "west-east" #4: routing:  kernel_ops_del_ipsec_spi() deleting sa 192.1.2.45-ESP[2dab1822]->192.1.2.23 for esp.ESPSPIi@192.1.2.23 ...
output: | sendrecv_xfrm_msg() sending 17 Del SA esp.ESPSPIi@192.1.2.23
output: | sendrecv_xfrm_msg() recvfrom() returned 36 bytes
output: | sendrecv_xfrm_msg() netlink response for Del SA esp.ESPSPIi@192.1.2.23 included non-error error
output: | "west-east" #4: routing:   ... yes
output: | kernel: uninstall_kernel_state() deleting INBOUND
output: | "west-east" #4: routing:  kernel_ops_del_ipsec_spi() deleting sa 192.1.2.23-ESP[6274be95]->192.1.2.45 for esp.ESPSPIi@192.1.2.45 ...
output: | sendrecv_xfrm_msg() sending 17 Del SA esp.ESPSPIi@192.1.2.45
output: | sendrecv_xfrm_msg() recvfrom() returned 36 bytes
output: | sendrecv_xfrm_msg() netlink response for Del SA esp.ESPSPIi@192.1.2.45 included non-error error
output: | "west-east" #4: routing:   ... yes
output: | delref @0x7f6b70babf38(4->3) (delete_state() +1033 programs/pluto/state.c)
output: | "west-east": delref @0x7f6b70b9da78(6->5)  #4:  (delete_state() +1073 programs/pluto/state.c)
output: | child state #4: IKE_AUTH_CHILD_I0(ignore) => UNDEFINED(ignore)
output: |  #4: releasing whack (but there are none) (delete_state() +1079 programs/pluto/state.c)
output: | delete_state: delref st->st_dh_shared_secret-key@NULL
output: | delete_state: delref st->st_skeyid_nss-key@NULL
output: | delete_state: delref st->st_skey_d_nss-key@0x7f6b70181f80
output: | delete_state: delref st->st_skey_ai_nss-key@NULL
output: | delete_state: delref st->st_skey_ar_nss-key@NULL
output: | delete_state: delref st->st_skey_ei_nss-key@0x7f6b70cc4f80
output: | delete_state: delref st->st_skey_er_nss-key@0x7f6b70b15f80
output: | delete_state: delref st->st_skey_pi_nss-key@0x7f6b70cb5f80
output: | delete_state: delref st->st_skey_pr_nss-key@0x7f6b70c0ef80
output: | delete_state: delref st->st_enc_key_nss-key@NULL
output: | delete_state: delref st->st_sk_d_no_ppk-key@NULL
output: | delete_state: delref st->st_sk_pi_no_ppk-key@NULL
output: | delete_state: delref st->st_sk_pr_no_ppk-key@NULL
output: |  #4: releasing whack (but there are none) (delete_state() +1172 programs/pluto/state.c)
output: | logger: delref @0x7f6b70078fc8(1->0) (delete_state() +1172 programs/pluto/state.c)
output: | "west-east" #4: routing: stop TEARDOWN_CHILD, ROUTED_TUNNEL->ROUTED_ONDEMAND, PERMANENT; ok=yes; routing_sa #4->#0 negotiating_ike_sa #3 established_ike_sa #3 negotiating_child_sa #4->#0 established_child_sa #4->#0 revival 1->2 (complete_v2_state_transition() +2823 programs/pluto/ikev2.c)
output: | "west-east": delref @0x7f6b70b9da78(5->4) "west-east" #4:  (dispatch() +2450 programs/pluto/routing.c)
output: | "west-east" #4: releasing whack (but there are none) (teardown_child() +1236 programs/pluto/routing.c)
output: | logger: delref @0x7f6b70036fc8(1->0) (teardown_child() +1236 programs/pluto/routing.c)
output: | FOR_EACH_STATE[clonedfrom=#3]... in (connection_zap_ike_family() +568 programs/pluto/terminate.c)
output: |   matches: 0
output: | clone logger: newref @0x7f6b70001fc8(0->1) (teardown_ike() +1278 programs/pluto/routing.c)
output: | "west-east": addref @0x7f6b70b9da78(4->5) "west-east" #3:  (dispatch() +2436 programs/pluto/routing.c)
output: | "west-east" #3: routing: start TEARDOWN_IKE, ROUTED_ONDEMAND, PERMANENT; IKE #3 (ESTABLISHED_IKE_SA) by=UNKNOWN; $1@0x7f6b70b9da78; negotiating_ike_sa #3 established_ike_sa #3 (complete_v2_state_transition() +2823 programs/pluto/ikev2.c)
output: | "west-east" #3: routing:   IKE SA does not match .routing_sa #0
output: | "west-east" #3: .st_on_delete.skip_send_delete yes->true (delete_ike_sa() +771 programs/pluto/state.c)
output: | "west-east" #3: delete_state() skipping log_message:no
output: | FOR_EACH_STATE[clonedfrom=#3]... in (delete_state() +873 programs/pluto/state.c)
output: |   matches: 0
output: "west-east" #3: deleting IKE SA (ESTABLISHED_IKE_SA) and NOT sending notification
output: | "west-east" #3: .st_on_delete.skip_log_message no->true (llog_sa_delete_n_send() +852 programs/pluto/state.c)
output: | pstats #3 ikev2.ike deleted completed
output: | #3 main thread spent 20.1 (138) milliseconds helper thread spent 5.23 (9.9) milliseconds in total
output: | suspend: no MD saved in state #3 (delete_state() +973 programs/pluto/state.c)
output: | #3 STATE_V2_ESTABLISHED_IKE_SA: retransmits: cleared
output: | pending: flush_pending_by_state() ike 0x7f6b70171348 pending 0x7f6b70183fa8
output: | pending: flush_pending_by_state() ike 0x7f6b70171348 pending 0x7f6b70183fa8 connection 0x7f6b70b9da78 ike 0x7f6b70171348
output: | pending: flush pending [0x7f6b70183fa8] Child SA connection "west-east" [0x7f6b70b9da78]
output: | "west-east": delref @0x7f6b70b9da78(5->4)  (delete_pending() +262 programs/pluto/pending.c)
output: | "west-east": releasing whack (but there are none) (delete_pending() +263 programs/pluto/pending.c)
output: | logger: delref @0x7f6b70ba5fc8(1->0) (delete_pending() +263 programs/pluto/pending.c)
output: | FOR_EACH_STATE[clonedfrom=#3]... in (flush_incomplete_children() +729 programs/pluto/state.c)
output: |   matches: 0
output: | "west-east" #3: disown .negotiating_ike_sa
output: | "west-east" #3: disown .established_ike_sa
output: | delref @0x7f6b70babf38(3->2) (delete_state() +1033 programs/pluto/state.c)
output: | "west-east": delref @0x7f6b70b9da78(4->3)  #3:  (delete_state() +1073 programs/pluto/state.c)
output: | parent state #3: ESTABLISHED_IKE_SA(established IKE SA) => UNDEFINED(ignore)
output: |  #3: releasing whack (but there are none) (delete_state() +1079 programs/pluto/state.c)
output: | delref @0x7f6b7002bfd8(1->0) (delete_state() +1094 programs/pluto/state.c)
output: | delete_state: delref st->st_dh_shared_secret-key@0x7f6b70c0cf80
output: | delete_state: delref st->st_skeyid_nss-key@NULL
output: | delete_state: delref st->st_skey_d_nss-key@0x7f6b70181f80
output: | delete_state: delref st->st_skey_ai_nss-key@NULL
output: | delete_state: delref st->st_skey_ar_nss-key@NULL
output: | delete_state: delref st->st_skey_ei_nss-key@0x7f6b70cc4f80
output: | delete_state: delref st->st_skey_er_nss-key@0x7f6b70b15f80
output: | delete_state: delref st->st_skey_pi_nss-key@0x7f6b70cb5f80
output: | delete_state: delref st->st_skey_pr_nss-key@0x7f6b70c0ef80
output: | delete_state: delref st->st_enc_key_nss-key@NULL
output: | delete_state: delref st->st_sk_d_no_ppk-key@NULL
output: | delete_state: delref st->st_sk_pi_no_ppk-key@NULL
output: | delete_state: delref st->st_sk_pr_no_ppk-key@NULL
output: |  #3: releasing whack (but there are none) (delete_state() +1172 programs/pluto/state.c)
output: | logger: delref @0x7f6b7002ffc8(1->0) (delete_state() +1172 programs/pluto/state.c)
output: | "west-east" #3: routing: stop TEARDOWN_IKE, ROUTED_ONDEMAND, PERMANENT; ok=yes; negotiating_ike_sa #3->#0 established_ike_sa #3->#0 (complete_v2_state_transition() +2823 programs/pluto/ikev2.c)
output: | "west-east": delref @0x7f6b70b9da78(3->2) "west-east" #3:  (dispatch() +2450 programs/pluto/routing.c)
output: | "west-east" #3: releasing whack (but there are none) (teardown_ike() +1290 programs/pluto/routing.c)
output: | logger: delref @0x7f6b70001fc8(1->0) (teardown_ike() +1290 programs/pluto/routing.c)
output: | in statetime_stop() and could not find #3
output: | packet from 192.1.2.23:500: delref @0x7f6b701f3708(2->1) (process_packet_with_secured_ike_sa() +2214 programs/pluto/ikev2.c)
output: | in statetime_stop() and could not find #3
output: | packet from 192.1.2.23:500: delref @0x7f6b701f3708(1->0) (process_iface_packet() +296 programs/pluto/demux.c)
output: | packet from 192.1.2.23:500: releasing whack (but there are none) (process_iface_packet() +296 programs/pluto/demux.c)
output: | logger: delref @0x7f6b70074fc8(1->0) (process_iface_packet() +296 programs/pluto/demux.c)
output: | delref @0x7f6b70babf38(2->1) (process_iface_packet() +296 programs/pluto/demux.c)
output: | spent 12.6 (80.5) milliseconds in process_iface_packet() reading and processing packet
output: | processing signal PLUTO_SIGCHLD
output: | waitpid returned ECHILD (no child processes left)
output: | spent 0.00511 (0.0963) milliseconds in signal handler PLUTO_SIGCHLD
output: | processing signal PLUTO_SIGCHLD
output: | waitpid returned ECHILD (no child processes left)
output: | spent 0.00457 (0.0967) milliseconds in signal handler PLUTO_SIGCHLD
output: | processing global timer EVENT_SHUNT_SCAN
output: | kernel: checking for aged bare shunts from shunt table to expire
output: | spent 0.0125 (0.131) milliseconds in global timer EVENT_SHUNT_SCAN
output: | kernel: netlink_process_xfrm_messages() process messages
output: | netlink_get() recvfrom() returned 248 bytes
output: | netlink_xfrm_message_processor() got XFRM_MSG_EXPIRE message with length 248
output: | xfrm_kernel_sa_expire() spi 00000000 src 192.0.1.254 dst 192.0.2.254 hard mode 0 proto 50 bytes 0 packets 0
output: | acquire state with SPI SPISPI expired, ignore it
west #
 ../../guestbin/ipsec-kernel-state.sh
west #
 ../../guestbin/ipsec-kernel-policy.sh
src 192.0.1.0/24 dst 192.0.2.0/24
	dir out priority PRIORITY ptype main
	tmpl src 0.0.0.0 dst 0.0.0.0
		proto esp reqid 0 mode transport
west #
 ipsec unroute west-east
west #
 
